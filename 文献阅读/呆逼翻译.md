摘要

蠕虫和间谍软件等zero-day网络攻击正变得越来越普遍和危险。现有的基于规则匹配的入侵检测机制常常不足以检测这些类型的攻击。因此，开发了异常入侵检测方法来应对这类攻击。  在各种异常检测方法中，支持向量机(SVM)被认为是分类异常行为的最佳机器学习算法之一。软边界支持向量机是一种著名的基于监督学习的支持向量机的基本方法。  然而，软边界支持向量机方法不适合用于检测网络流量中的新攻击，因为在监督学习过程中需要预先获取学习信息。  将这些预先获得的学习信息分为正常流量和攻击流量，并分别贴上标签。此外，我们使用无监督学习的单类支持向量机方法来检测异常。  这意味着单类SVM不需要标记信息。然而，使用单类支持向量机也有其缺点:由于单类支持向量机的假阳性率高，在现实中难以使用。在本文中，我们提出了一种新的SVM方法，名为ESVM，它结合了这两种方法，以提供无监督学习和低误报率能力，类似于有监督的SVM方法。 

 首先，我们使用自组织特征映射(SOFM)创建一个正常包的轮廓，用于支持向量机学习，而不需要预先存在的知识。其次，我们使用基于被动TCP/IP指纹(PTF)的数据包过滤方案，以拒绝在知名平台中违反TCP/IP标准或生成策略的不完整网络流量。第三，使用一种使用遗传算法(GA)的特征选择技术从原始互联网数据包中提取优化信息。第四，在数据预处理过程中，我们使用基于时间关系的数据包流，以考虑SVM学习中使用的输入之间的时间关系。最后，我们在麻省理工学院林肯实验室数据集和从真实网络捕获的实时数据集上，使用上述技术如SOFM、PTF和GA来演示增强SVM方法的有效性。 

---

背景

 互联网已经成为我们日常生活的一部分。它现在是在许多领域如商业、教育和许多其他领域生存的重要工具。企业尤其把互联网作为其商业模式的重要组成部分。  企业不仅使用web和电子邮件等互联网应用程序来创收和与客户沟通，而且客户经常使用可通过互联网访问的机器来存储重要的专有信息。虽然这可能会帮助企业更有效地运作，但也会让它们非常容易受到攻击，包括窃取数据和阻碍企业运营。  在Internet上发现实施攻击的风险很小的环境是很常见的。这些风险是匿名率高和警方缺乏兴趣的结果。然而，攻击可以很容易地通过攻击预防方案规避。为了防止这种攻击，已经设计或提议了许多系统来阻止基于internet的攻击。  目前，许多最常用的系统都基于规则匹配，这些规则是可能指示攻击的独特模式或条件。这些系统似乎很有效;然而，基于规则匹配的网络入侵检测系统存在许多缺陷。  第一个问题是，这些系统变成了单点故障。如果部署的NIDS系统由于任何原因而被禁用，那么它通常会给攻击者所需的时间来破坏系统并可能在网络中获得一个立足点。  此外，如果没有正确地配置或维护NIDS系统，它们可能会提供一种错误的安全感。此外，研究表明，如果签名在描述攻击条件方面不够健壮，那么可以进行简单的修改，以允许攻击成功。  除了签名的健壮性，基于签名的入侵检测系统还依赖人工干预来创建、测试和部署签名。因此，可能需要花费数小时或数天的时间来为攻击生成新的签名，而在处理快速移动的攻击(如蠕虫传播)时，这个签名可能会太长。在不需要人工干预的自动签名生成方面已经做了一些工作，但是这些系统还没有为大规模部署做好准备。 

---

 总体框架 

 异常检测框架的总体结构由四个主要步骤组成，如图1所示。

![1599464640087](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\1599464640087.png)

第一步，与在线处理相关的使用PTF进行实时流量过滤，脱机处理包括使用SOFM进行数据聚类，以及使用GA进行数据包字段选择。  我们使用PTF来丢弃格式错误的数据包，根据定义，这些数据包对网络是无效的。这为包预处理提供了更好的性能，并减少了原始流量的潜在攻击数量。在运行整个框架之前，使用遗传算法进行离线字段选择和使用SOFM进行数据包聚类。 遗传算法通过自然进化过程在数据包中选择最优的字段，并将所选择的字段实时应用到过滤后的数据包中。离线进行基于sofm的包聚类，创建用于SVM学习的包配置文件，然后使用这些包配置文件生成更合适的训练数据。  

 第二步，对滤波后的包进行预处理，以提高检测性能。在此数据预处理步骤中，对通过第一步的数据包进行基于流量的分组关系预处理，用于SVM学习输入。  我们之所以考虑包之间的关系，是因为在预处理过程中使用了根据IP识别码滑动窗口的概念，使支持向量机输入具有时间特征。

第三步包括增强的SVM机器学习方法(用于训练和测试)，如第1章所述。支持向量机模型结合了两种机器学习方法:有监督的软边界支持向量机和无监督的单类支持向量机。在此基础上，改进后的SVM继承了软边界支持向量机的高性能和单类支持向量机的新颖性检测能力。最后一步需要使用m-fold交叉验证测试来验证这种方法，并将所提议的框架与现实世界的NIDSs(如Bro[31]和Snort[34])进行比较。 

 本文的其余部分组织如下。在第3节中，我们将介绍SOFM、PTF和GA，它们是用于增强所提方法性能的补充技术。在第4节中，我们提出了监督和无监督支持向量机方法的结合以及所提出的机器学习方法。在第5节和第6节中，我们将解释实验方法以及数据预处理、数据描述和参数设置。在最后一节中，我们对未来的工作进行了总结和讨论。 

---

  Packet profiling using SOFM  

 收集正常数据是机器学习领域中最重要的方面之一，因为这些收集的数据是训练一个监督学习系统所必需的。此外，正常数据可以为无监督机器学习系统提供智能判据。在提出的机器学习框架中，需要将用于正常学习的数据包作为正确学习的衡量标准。  因此，我们必须提供一个合理的规则，以显示用于学习的包具有正常的特征。然而，这不是一项简单的任务;为此，需要一种新的方法，如数据挖掘方案，来构造一个具有正常数据包(无攻击)的标准化组(正常配置文件)。  如果我们提供一个合理的方法来创建一个正常的轮廓，它将提高框架的广义检测能力。数据挖掘领域需要的另一个工具是数据集群。在本节中，我们使用了机器学习算法自组织神经网络 (SOFM)，该算法能够生成聚类，如[8,25,43]所示。目的是生成几个聚类，并与正常特征区分。 

 SOFM是一个无监督的神经网络模型，用于分析和可视化高维数据到二维格。换句话说，SOFM可以正式定义为高维输入数据流形到规则的低维数组元素的非线性、有序、平滑的映射。  该方法将高维空间数据点之间的非线性统计关系转化为二维映射中的几何关系。而且，它与竞争学习的不同之处在于，SOFM中的相邻神经元学习识别输入空间的相邻部分，而它属于竞争学习算法家族。因此，SOFM从用于训练的输入向量的分布和拓扑中学习。SOFM的学习过程与竞争学习网络相似。换句话说，选择一个相似性度量，获胜单位被认为是激活最大的单位。然而，对于Kohonen feature map，我们更新了所有的权重，包括获胜单位的权重，在获胜单位周围的邻域内。一般情况下，邻域的大小随迭代次数的增加而缓慢减小。 

 如何训练Kohonen自组织网络[25,43]的顺序描述如下: 

![1599466531451](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\1599466531451.png)

 当我们提供上面描述的高维输入时，SOFM可以使用拓扑和距离将其转换为二维空间并生成各种集群。在问题域中，根据数据包的属性做出各种SOFM簇。此时在这个过程中,如果我们标签生成的集群使用统计方法或验证过程(通过离线分析区分正常和异常),那么他将会使用一些集群作为一个正常的包配置文件,或一个概要文件包展示正常数据包的功能。不仅如此，使用SOFM的无监督集群不需要任何其他措施来创建集群，因为它只依赖于给定输入的原始特征。因此，SOFM可以作为定义普通包类的简单而有效的方法。 

---

PTF

 TCP/IP指纹识别是通过使用在每个OS[18]的TCP/IP堆栈中发现的独特特性来确定远程主机操作系统的标识的过程。根据主机是否发送探测包，该方法可分为主动方案和被动方案。目前，Xprobe[3]和Nmap[16]等活动方案是主要的OS指纹识别工具。它们通过向目标发送一系列信息包并分析返回的信息包的行为或已知在某些系统上发生的值进行操作。与任何启发式方法一样，这种方法需要更新，但是，可以从精心构造的包中收集大量的信息。被动方案与主动指纹方法相似，都是根据操作系统对数据包进行分析和关联。  然而，这些计划以不同的方式运作。首先，被动指纹识别利用了数据包嗅探器。这意味着它建立在网络上，被动地收集/分析主机之间的数据包。因此，被动指纹在交换网中的作用明显有限;但是，如果它与路由器或利用良好的网络主机连接在共享的网络空间中，它可能是有用的。  PTF使用一些与主动指纹相同的技术，但是等待信息返回。像p0f[47]这样的工具具有多种模式，可用于确定传出连接、传入连接或已建立连接的操作系统。

 包过滤器用于确认接收到的包的结构。换句话说，如果一个数据包被认为没有使用已知平台的结构(其中一些遵循适当的rfc)，那么它将被丢弃。基于严格标准遵从性的过滤不是经常违反规则的系统的选项，比如Microsoft Windows。如前所述，指纹使用启发式，因此可以期望正确地识别正常系统，只要它们足够常见，或者提交了关于系统的指纹。允许数据包通过这个初始检查程序并不意味着它是安全的，但它只意味着更有可能是一个正常生成的数据包。通过使用这种对正常行为的初步判断，我们希望减少许多精心设计的包类型，比如隐蔽通道和一些主动扫描探针。 